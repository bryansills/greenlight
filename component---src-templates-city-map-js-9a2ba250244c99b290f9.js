(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{146:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(7),i=n.n(r),s=n(166),u=n(168),c=n.n(u),p=(n(33),n(76)),l=n.n(p),d=n(164),m=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).state={},e._updateDimensions=function(){if("undefined"!=typeof window){var t=window.innerHeight;e.setState({height:t}),e.forceUpdate()}},e}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){"undefined"!=typeof window&&(window.addEventListener("resize",this._updateDimensions),this._updateDimensions())},n.componentWillUnmount=function(){"undefined"!=typeof window&&window.removeEventListener("resize",this._updateDimensions)},n.render=function(){var t=this.props,e=t.children,n=l()(t,["children"]),o=this.state.height;return"undefined"!=typeof window&&o?a.a.createElement(d.a,Object.assign({style:{height:o}},n),e):null},e}(a.a.Component),f=n(142),h=n.n(f),g=function(t){function e(){return t.apply(this,arguments)||this}return i()(e,t),e.prototype.render=function(){var t=this.props,e=t.position,n=t.zoom,o=t.points;return a.a.createElement("div",{className:h.a.map},a.a.createElement(m,{center:e,zoom:n},a.a.createElement(s.a,{attribution:'Â© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),o&&o.length>0&&a.a.createElement(c.a,{points:o,latitudeExtractor:function(t){return t[0]},longitudeExtractor:function(t){return t[1]},intensityExtractor:function(t){return parseFloat(t[2])}})))},e}(a.a.Component),v=n(180),b=n.n(v),y=(n(143),n(144)),w=n.n(y),D=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this)._onChange=function(t){e.props.onObstructionChange(t.target.value)},e._formatLabel=function(t,n){var o=e.props.baseDate;return"max"===n?"Latest":"min"===n?"Oldest":o.clone().add(t,"days").format("MMM YYYY")},e._renderOptions=function(){return e.props.obstructions.map(function(t){return a.a.createElement("option",{key:t.key,value:t.key},t.spinner)})},e}return i()(e,t),e.prototype.render=function(){var t=this.props,e=t.selectedObstruction,n=t.minDate,o=t.maxDate,r=t.dateRange,i=t.onDateRangeChange;return a.a.createElement("div",{className:w.a.filters_positioning},a.a.createElement("div",{className:w.a.filters_container},a.a.createElement("select",{value:e,onChange:this._onChange},this._renderOptions()),a.a.createElement(b.a,{minValue:n,maxValue:o,value:r,formatLabel:this._formatLabel,onChange:i})))},e}(a.a.Component);D.defaultProps={obstructions:[]};var E=n(196),C=n.n(E),O=function(t){function e(e){var n;(n=t.call(this,e)||this)._onObstructionChange=function(t){return n.setState({selectedOption:t})},n._onDateRangeChange=function(t){return n.setState({dateRange:t})};var o=C()("2017-08-29"),a=C()().diff(o,"days");return n.state={selectedOption:e.options[0].key,baseDate:o,minDate:0,maxDate:a,dateRange:{min:0,max:a}},n}return i()(e,t),e.prototype.render=function(){var t=this.props,e=t.position,n=t.zoom,o=t.options,r=t.getGroupedPoints,i=this.state,s=i.selectedOption,u=i.baseDate,c=i.minDate,p=i.maxDate,l=i.dateRange,d=r(s);return a.a.createElement("div",null,a.a.createElement(g,{position:e,zoom:n,points:d}),a.a.createElement(D,{obstructions:o,selectedObstruction:s,onObstructionChange:this._onObstructionChange,baseDate:u,minDate:c,maxDate:p,dateRange:l,onDateRangeChange:this._onDateRangeChange}))},e}(a.a.Component),_=(n(75),n(55),n(36),n(197),n(199),function(t){return function(e){var n=t.filter(function(t){return t.obstruction===e||"all"===e}).reduce(function(t,e){var n,o=e.lat,a=e.long,r=o+","+a,i=t[r],s=i?i.count:0;return Object.assign({},t,((n={})[r]={lat:o,long:a,count:s+1},n))},{});return Object.values(n).sort(function(t,e){return e.count-t.count}).map(function(t){return[t.lat,t.long,t.count]})}});n.d(e,"query",function(){return x});e.default=function(t){var e=t.data,n=e.cityConfig,o=e.obstructions,r=e.points,i=n.position,s=n.zoom;return a.a.createElement("div",{id:"map"},a.a.createElement(O,{position:i,zoom:s,options:o.result,getGroupedPoints:_(r.file.result)}))};var x="3903265231"}}]);
//# sourceMappingURL=component---src-templates-city-map-js-9a2ba250244c99b290f9.js.map